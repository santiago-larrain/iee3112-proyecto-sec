{
  "metadata": {
    "version": "1.0",
    "fecha": "2025-11-13",
    "descripcion": "Estructura del sistema para diseño en Figma"
  },
  "capas": [
    {
      "nombre": "ENTRADA",
      "color": "#E3F2FD",
      "componentes": [
        {
          "nombre": "Reclamo JSON",
          "tipo": "archivo",
          "ruta": "datos/reclamo_ejemplo.json",
          "formato": "JSON"
        },
        {
          "nombre": "Credenciales",
          "tipo": "archivo",
          "ruta": "datos/credenciales_ejemplo.json",
          "formato": "JSON",
          "opcional": true
        },
        {
          "nombre": "Base de Datos",
          "tipo": "base_datos",
          "ruta": "data/sec_reclamos.db",
          "tablas": ["reclamos", "boletas", "expedientes"]
        }
      ]
    },
    {
      "nombre": "PROCESAMIENTO",
      "color": "#FFF3E0",
      "modulos": [
        {
          "nombre": "Obtención de Boletas",
          "color": "#2196F3",
          "ruta": "modulos/obtencion_boletas/",
          "componentes": [
            {
              "nombre": "ScraperFactory",
              "archivo": "scrapers/scraper_factory.py",
              "descripcion": "Crea scrapers según distribuidora"
            },
            {
              "nombre": "ScraperBase",
              "archivo": "scraper_base.py",
              "descripcion": "Clase base abstracta",
              "tipo": "abstracta"
            },
            {
              "nombre": "EnelScraper",
              "archivo": "scrapers/enel_scraper.py",
              "descripcion": "Scraper específico para Enel",
              "estado": "completo"
            },
            {
              "nombre": "ExtractorDatos",
              "archivo": "procesamiento/extractor_datos.py",
              "descripcion": "Parsea PDF/HTML a JSON"
            },
            {
              "nombre": "ValidadorBoletas",
              "archivo": "procesamiento/validador_boletas.py",
              "descripcion": "Valida completitud y corrección"
            }
          ],
          "flujo_interno": [
            "ScraperFactory → Scraper Específico",
            "Login → Obtener Boletas",
            "ExtractorDatos → Parsear",
            "ValidadorBoletas → Validar",
            "BaseDatos → Guardar"
          ]
        },
        {
          "nombre": "Consolidación Jurídico-Técnica",
          "color": "#FF9800",
          "ruta": "modulos/consolidacion_juridico_tecnica/",
          "componentes": [
            {
              "nombre": "ClasificadorTipologias",
              "archivo": "clasificador_tipologias.py",
              "descripcion": "Clasifica reclamo según tipología SEC",
              "usa": ["docs/manual_reclamos_2025.json"]
            },
            {
              "nombre": "AnalizadorReclamos",
              "archivo": "analizador_reclamos.py",
              "descripcion": "Analiza reclamo según procedimiento",
              "tipologias": {
                "completas": ["facturacion_excesiva"],
                "parciales": ["facturacion_provisoria", "cnr", "cobros_indebidos"]
              },
              "usa": ["docs/manual_reclamos_2025.json", "docs/resolucion_exenta_1952.json"]
            },
            {
              "nombre": "EvaluadorCumplimiento",
              "archivo": "evaluador_cumplimiento.py",
              "descripcion": "Evalúa cumplimiento normativo",
              "evalua": ["plazos", "medios_probatorios", "consistencia", "respuesta"]
            },
            {
              "nombre": "GeneradorExpediente",
              "archivo": "generador_expediente.py",
              "descripcion": "Genera expediente estructurado",
              "formatos": ["JSON", "TXT"]
            }
          ],
          "flujo_interno": [
            "ClasificadorTipologias → AnalizadorReclamos",
            "AnalizadorReclamos → GeneradorExpediente",
            "GeneradorExpediente → EvaluadorCumplimiento"
          ]
        },
        {
          "nombre": "Ficha Técnica y Checklist",
          "color": "#4CAF50",
          "ruta": "modulos/ficha_tecnica_checklist/",
          "componentes": [
            {
              "nombre": "GeneradorInforme",
              "archivo": "generador_informe.py",
              "descripcion": "Genera informe ejecutivo",
              "formatos": ["JSON", "TXT"]
            },
            {
              "nombre": "GeneradorInstrucciones",
              "archivo": "generador_instrucciones.py",
              "descripcion": "Genera instrucciones automáticas",
              "formatos": ["JSON", "TXT"]
            },
            {
              "nombre": "GeneradorFicha",
              "archivo": "generador_ficha.py",
              "descripcion": "Genera ficha técnica completa",
              "formatos": ["PDF", "HTML"],
              "usa": ["GeneradorInforme", "GeneradorInstrucciones", "templates/*.html", "matplotlib"]
            },
            {
              "nombre": "ChecklistCumplimiento",
              "archivo": "checklist_cumplimiento.py",
              "descripcion": "Genera checklist verificable",
              "formatos": ["PDF", "HTML", "JSON"],
              "usa": ["templates/checklist.html"]
            }
          ],
          "flujo_interno": [
            "GeneradorInforme + GeneradorInstrucciones → GeneradorFicha",
            "EvaluadorCumplimiento → ChecklistCumplimiento"
          ]
        },
        {
          "nombre": "Utilidades",
          "color": "#9E9E9E",
          "ruta": "modulos/utils/",
          "componentes": [
            {
              "nombre": "Config",
              "archivo": "config.py",
              "descripcion": "Gestión de configuración",
              "usa": ["config/config.yaml"]
            },
            {
              "nombre": "Logger",
              "archivo": "logger.py",
              "descripcion": "Sistema de logging",
              "salida": ["console", "logs/sec_reclamos.log"]
            },
            {
              "nombre": "BaseDatos",
              "archivo": "base_datos.py",
              "descripcion": "Gestión de base de datos SQLite",
              "tablas": ["reclamos", "boletas", "expedientes"]
            }
          ]
        },
        {
          "nombre": "Orquestador Principal",
          "color": "#9C27B0",
          "ruta": "modulos/main.py",
          "componente": {
            "nombre": "SistemaAnalisisReclamos",
            "descripcion": "Orquesta todo el flujo",
            "conecta": "todos los módulos"
          }
        }
      ]
    },
    {
      "nombre": "SALIDA",
      "color": "#E8F5E9",
      "componentes": [
        {
          "nombre": "Expediente",
          "formatos": ["JSON", "TXT"],
          "ruta": "data/expedientes/EXP-{NUMERO}-{FECHA}.{json|txt}"
        },
        {
          "nombre": "Ficha Técnica",
          "formatos": ["PDF", "HTML"],
          "ruta": "data/expedientes/FICHA-{NUMERO}-{FECHA}.{pdf|html}"
        },
        {
          "nombre": "Checklist",
          "formatos": ["PDF", "HTML", "JSON"],
          "ruta": "data/expedientes/CHECKLIST-{NUMERO}-{FECHA}.{pdf|html|json}"
        },
        {
          "nombre": "Informe",
          "formatos": ["JSON"],
          "ruta": "Estructura en memoria (puede formatearse a texto)"
        },
        {
          "nombre": "Instrucciones",
          "formatos": ["JSON"],
          "ruta": "Estructura en memoria (puede formatearse a texto)"
        },
        {
          "nombre": "Base de Datos",
          "tipo": "base_datos",
          "ruta": "data/sec_reclamos.db",
          "accion": "Actualizada con resultados"
        },
        {
          "nombre": "Logs",
          "tipo": "archivo",
          "ruta": "logs/sec_reclamos.log"
        }
      ]
    }
  ],
  "flujo_completo": {
    "pasos": [
      {
        "numero": 1,
        "nombre": "Obtener Boletas",
        "modulo": "Obtención de Boletas",
        "componentes": ["ScraperFactory", "Scraper Específico", "ExtractorDatos", "ValidadorBoletas", "BaseDatos"]
      },
      {
        "numero": 2,
        "nombre": "Clasificar Tipología",
        "modulo": "Consolidación Jurídico-Técnica",
        "componentes": ["ClasificadorTipologias"]
      },
      {
        "numero": 3,
        "nombre": "Analizar Reclamo",
        "modulo": "Consolidación Jurídico-Técnica",
        "componentes": ["AnalizadorReclamos"]
      },
      {
        "numero": 4,
        "nombre": "Generar Expediente",
        "modulo": "Consolidación Jurídico-Técnica",
        "componentes": ["GeneradorExpediente"]
      },
      {
        "numero": 5,
        "nombre": "Evaluar Cumplimiento",
        "modulo": "Consolidación Jurídico-Técnica",
        "componentes": ["EvaluadorCumplimiento"]
      },
      {
        "numero": 6,
        "nombre": "Generar Informe",
        "modulo": "Ficha Técnica y Checklist",
        "componentes": ["GeneradorInforme"]
      },
      {
        "numero": 7,
        "nombre": "Generar Instrucciones",
        "modulo": "Ficha Técnica y Checklist",
        "componentes": ["GeneradorInstrucciones"]
      },
      {
        "numero": 8,
        "nombre": "Generar Ficha Técnica",
        "modulo": "Ficha Técnica y Checklist",
        "componentes": ["GeneradorFicha", "GeneradorInforme", "GeneradorInstrucciones"]
      },
      {
        "numero": 9,
        "nombre": "Generar Checklist",
        "modulo": "Ficha Técnica y Checklist",
        "componentes": ["ChecklistCumplimiento"]
      },
      {
        "numero": 10,
        "nombre": "Guardar Resultados",
        "modulo": "Utilidades",
        "componentes": ["BaseDatos"]
      }
    ]
  },
  "conexiones": [
    {
      "desde": "main.py",
      "hacia": "Todos los módulos",
      "tipo": "orquestación"
    },
    {
      "desde": "Obtención Boletas",
      "hacia": "BaseDatos",
      "tipo": "guardar boletas"
    },
    {
      "desde": "ClasificadorTipologias",
      "hacia": "AnalizadorReclamos",
      "tipo": "tipología → análisis"
    },
    {
      "desde": "AnalizadorReclamos",
      "hacia": "GeneradorExpediente",
      "tipo": "análisis → expediente"
    },
    {
      "desde": "EvaluadorCumplimiento",
      "hacia": "GeneradorExpediente",
      "tipo": "cumplimiento → expediente"
    },
    {
      "desde": "GeneradorFicha",
      "hacia": "GeneradorInforme + GeneradorInstrucciones",
      "tipo": "usar ambos para ficha completa"
    },
    {
      "desde": "Todos",
      "hacia": "Logger",
      "tipo": "registro de eventos"
    },
    {
      "desde": "Todos",
      "hacia": "Config",
      "tipo": "configuración"
    }
  ],
  "recursos_externos": [
    {
      "nombre": "Manual SEC",
      "ruta": "docs/manual_reclamos_2025.json",
      "usa": ["ClasificadorTipologias", "AnalizadorReclamos"]
    },
    {
      "nombre": "Resolución 1952",
      "ruta": "docs/resolucion_exenta_1952.json",
      "usa": ["AnalizadorReclamos"]
    },
    {
      "nombre": "Templates HTML",
      "ruta": "modulos/ficha_tecnica_checklist/templates/",
      "usa": ["GeneradorFicha", "ChecklistCumplimiento"]
    },
    {
      "nombre": "Portales Web",
      "tipo": "externo",
      "usa": ["Scrapers"]
    }
  ],
  "estado_implementacion": {
    "completo": [
      "Estructura base del sistema",
      "Obtención de boletas (Enel)",
      "Clasificación de tipologías",
      "Análisis de Facturación Excesiva",
      "Evaluación de cumplimiento",
      "Generación de expedientes",
      "Ficha técnica completa",
      "Checklist de cumplimiento",
      "Informe ejecutivo",
      "Instrucciones automáticas"
    ],
    "parcial": [
      "Análisis de otras tipologías (placeholders)",
      "Scrapers de otras distribuidoras"
    ],
    "pendiente": [
      "Integración con PESEC",
      "Automatización/scheduler",
      "Tests exhaustivos"
    ]
  }
}

